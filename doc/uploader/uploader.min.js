!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ImageUploader=e()}}(function(){return function e(t,i,s){function n(d,o){if(!i[d]){if(!t[d]){var a="function"==typeof require&&require;if(!o&&a)return a(d,!0);if(r)return r(d,!0);var l=new Error("Cannot find module '"+d+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[d]={exports:{}};t[d][0].call(u.exports,function(e){var i=t[d][1][e];return n(i?i:e)},u,u.exports,e,t,i,s)}return i[d].exports}for(var r="function"==typeof require&&require,d=0;d<s.length;d++)n(s[d]);return n}({1:[function(e,t,i){function s(e){return"string"==typeof e&&(e=document.querySelector(e)),e}function n(e,t){for(var i in t)t.hasOwnProperty(i)&&(d(e[i])?e[i]=n(e[i],t[i]):e[i]=t[i]);return e}function r(e){var t=document.createElement("div");t.innerHTML=e;var i;return i="undefined"!=typeof t.content||t.content?t.content.firstElementChild.cloneNode(!0):t.firstElementChild.cloneNode(!0)}function d(e){return e&&"object"==typeof e&&e.constructor==Object}t.exports={querySelector:s,extend:n,parseHTML:r,isPlainObject:d}},{}],2:[function(e,t,i){function s(e){this.pictures.push(e);var t=!0,i=l.call(this,e,t);this.el.insertBefore(i,this.addView),this.pictureViews.push(i),this.options.maxItems&&(this.pictures.length>=this.options.maxItems?this.addView.classList.add("hidden"):this.addView.classList.remove("hidden"))}function n(e,t){this.pictures[e]=t,this.pictureViews[e].querySelector("img").setAttribute("src",t.url)}function r(e){var t=this.pictureViews[e];t.parentNode.removeChild(t),this.pictures.splice(e,1),this.pictureViews.splice(e,1),this.options.maxItems&&(this.pictures.length>=this.options.maxItems?this.addView.classList.add("hidden"):this.addView.classList.remove("hidden"))}function d(){this.el.classList.contains("uploader")||this.el.classList.add("uploader"),o.call(this),a.call(this)}function o(){var e='<div class="uploader-item"><input type="file" class="hidden" data-js="file-input"><button class="uploader__btn-add" data-js="openFilePicker">Add</button></div>';this.addView=f.parseHTML(e),this.fileInput=this.addView.querySelector('[data-js="file-input"]');var t=this;this.addView.querySelector('[data-js="openFilePicker"]').addEventListener("click",function(e){e.preventDefault(),t.editMode=!1,t.fileInput.click()}),this.fileInput.addEventListener("change",function(e){h.call(t,this)}),this.el.appendChild(this.addView)}function a(){var e='<div class="uploader-item hidden"><div class="uploader__progress"><span style="width: 0%" data-js="progress-bar"></span></div><div class="uploader__loading">Envoi en cours...</div></div>';this.progressView=f.parseHTML(e),this.progressBar=this.progressView.querySelector('[data-js="progress-bar"]')}function l(e,t){var i='<div class="uploader-item">';t&&(i+='<button class="uploader__btn" data-js="delete">Delete</button>'),i+='<button class="uploader__btn" data-js="edit">Edit</button><img src="'+e.url+'"></div>';var s=f.parseHTML(i),n=this;s.querySelector('[data-js="edit"]').addEventListener("click",function(e){e.preventDefault();var t=n.pictureViews.indexOf(s);n.editMode=!0,n.editIndex=t,n.fileInput.click()});var d=s.querySelector('[data-js="delete"]');return d&&d.addEventListener("click",function(e){e.preventDefault();var t=n.pictureViews.indexOf(s);if(-1!=t){var i=n.pictures[t];n.options.ajax["delete"](i,function(){r.call(n,t)})}}),s}function u(){if(this.progressBar.style.width="0%",this.progressView.classList.remove("hidden"),this.editMode){var e=this.pictureViews[this.editIndex];e.classList.add("hidden"),this.el.insertBefore(this.progressView,e)}else this.addView.classList.add("hidden"),this.el.insertBefore(this.progressView,this.addView)}function c(){this.progressView.parentNode.removeChild(this.progressView)}function p(e){this.progressBar.style.width=e.toFixed()+"%"}function h(e){if(0!=e.length){var t=e.files[0],i=this;if(u.call(this),i.editMode){var r=i.pictures[i.editIndex];this.options.ajax.update(r,t,function(e){c.call(i),n.call(i,i.editIndex,e),i.pictureViews[i.editIndex].classList.remove("hidden")},function(e){p.call(i,e)})}else this.options.ajax.add(t,function(e){c.call(i),s.call(i,e)},function(e){p.call(i,e)});this.fileInput.value=null}}var f=e("./helper"),v={maxItems:null,ajax:{add:function(e,t,i){},update:function(e,t,i,s){},"delete":function(e,t){}}},w=function(e,t){this.el=f.querySelector(e),this.options=f.extend(v,t),this.pictures=[],this.pictureViews=[],this.addView=null,this.fileInput=null,this.progressView=null,this.progressBar=null,this.editMode=!1,this.editIndex=null,d.call(this)};t.exports=w},{"./helper":1}]},{},[2])(2)});